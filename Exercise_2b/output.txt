>> start data preparation
>> done preparing data

FIRST CROSS-VALIDATION (FOR NUMBER OF NEURONS AND LEARNING RATE)
----------------------------------------------------------------
 
 nn | lr  | acc
------------------
 10 | 0.1 | 0.8424
 10 | 0.2 | 0.5895
 10 | 0.3 | 0.5441
 10 | 0.4 | 0.7354
 10 | 0.5 | 0.3872
 10 | 0.6 | 0.2066
 10 | 0.7 | 0.2004
 10 | 0.8 | 0.2040
 10 | 0.9 | 0.1655
 10 | 1.0 | 0.0998
 20 | 0.1 | 0.9250
 20 | 0.2 | 0.7388
 20 | 0.3 | 0.8153
 20 | 0.4 | 0.7686
 20 | 0.5 | 0.6652
 20 | 0.6 | 0.3102
 20 | 0.7 | 0.3093
 20 | 0.8 | 0.2122
 20 | 0.9 | 0.1437
 20 | 1.0 | 0.1228
 30 | 0.1 | 0.9355
 30 | 0.2 | 0.9252
 30 | 0.3 | 0.9154
 30 | 0.4 | 0.9119
 30 | 0.5 | 0.7077
 30 | 0.6 | 0.5552
 30 | 0.7 | 0.3356
 30 | 0.8 | 0.2123
 30 | 0.9 | 0.2140
 30 | 1.0 | 0.1611
 40 | 0.1 | 0.9090
 40 | 0.2 | 0.8191
 40 | 0.3 | 0.8727
 40 | 0.4 | 0.8331
 40 | 0.5 | 0.8439
 40 | 0.6 | 0.6860
 40 | 0.7 | 0.4695
 40 | 0.8 | 0.2661
 40 | 0.9 | 0.2823
 40 | 1.0 | 0.1969
 50 | 0.1 | 0.9584
 50 | 0.2 | 0.9643
 50 | 0.3 | 0.9041
 50 | 0.4 | 0.9509
 50 | 0.5 | 0.7860
 50 | 0.6 | 0.7536
 50 | 0.7 | 0.4184
 50 | 0.8 | 0.3040
 50 | 0.9 | 0.2252
 50 | 1.0 | 0.1517
 60 | 0.1 | 0.9644
 60 | 0.2 | 0.9433
 60 | 0.3 | 0.9468
 60 | 0.4 | 0.9514
 60 | 0.5 | 0.9004
 60 | 0.6 | 0.6315
 60 | 0.7 | 0.4836
 60 | 0.8 | 0.2480
 60 | 0.9 | 0.2562
 60 | 1.0 | 0.1935
 70 | 0.1 | 0.9644
 70 | 0.2 | 0.9577
 70 | 0.3 | 0.7603
 70 | 0.4 | 0.9486
 70 | 0.5 | 0.8817
 70 | 0.6 | 0.7557
 70 | 0.7 | 0.5415
 70 | 0.8 | 0.3825
 70 | 0.9 | 0.2074
 70 | 1.0 | 0.2227
 80 | 0.1 | 0.9651
 80 | 0.2 | 0.9556
 80 | 0.3 | 0.8060
 80 | 0.4 | 0.9044
 80 | 0.5 | 0.8295
 80 | 0.6 | 0.8141
 80 | 0.7 | 0.7615
 80 | 0.8 | 0.4798
 80 | 0.9 | 0.2558
 80 | 1.0 | 0.2133
 90 | 0.1 | 0.9683
 90 | 0.2 | 0.9447
 90 | 0.3 | 0.9443
 90 | 0.4 | 0.9477
 90 | 0.5 | 0.8941
 90 | 0.6 | 0.8488
 90 | 0.7 | 0.4877
 90 | 0.8 | 0.3804
 90 | 0.9 | 0.2185
 90 | 1.0 | 0.2376
100 | 0.1 | 0.9691
100 | 0.2 | 0.9618
100 | 0.3 | 0.9659
100 | 0.4 | 0.9323
100 | 0.5 | 0.9398
100 | 0.6 | 0.8343
100 | 0.7 | 0.7900
100 | 0.8 | 0.4254
100 | 0.9 | 0.2940
100 | 1.0 | 0.1595

nn = number of neurons
lr = learning rate
acc = accuracy

Best parameter combination:
number of hidden layers = 100
learning rate = 0.1

Time elapsed: 1234.830 s

SECOND CROSS-VALIDATION (FOR TOLERANCE)
---------------------------------------

tolerance = 0.1
------------------

 ni | loss   | acc
---------------------
  5 | 0.0925 | 0.9607
  5 | 0.0887 | 0.9617
  5 | 0.0892 | 0.9609
  5 | 0.0933 | 0.9596
  5 | 0.0931 | 0.9576

Training on entire training set needed 5 iterations, ended with loss 0.0785 and achieved accuracy 0.9645.

tolerance = 0.01
------------------

 ni | loss   | acc
---------------------
 11 | 0.0271 | 0.9665
 10 | 0.0293 | 0.9630
 11 | 0.0281 | 0.9689
 11 | 0.0298 | 0.9646
 11 | 0.0258 | 0.9689

Training on entire training set needed 11 iterations, ended with loss 0.0240 and achieved accuracy 0.9707.

tolerance = 0.001
------------------

 ni | loss   | acc
---------------------
 22 | 0.0052 | 0.9656
 21 | 0.0053 | 0.9693
 23 | 0.0052 | 0.9709
 21 | 0.0056 | 0.9691
 24 | 0.0046 | 0.9718

Training on entire training set needed 23 iterations, ended with loss 0.0044 and achieved accuracy 0.9710.

tolerance = 0.0001
------------------

 ni | loss   | acc
---------------------
 41 | 0.0019 | 0.9678
 38 | 0.0020 | 0.9663
 39 | 0.0021 | 0.9693
 39 | 0.0019 | 0.9694
 40 | 0.0020 | 0.9685

Training on entire training set needed 37 iterations, ended with loss 0.0019 and achieved accuracy 0.9724.

tolerance = 1e-05
------------------

 ni | loss   | acc
---------------------
 85 | 0.0008 | 0.9689
 88 | 0.0008 | 0.9691
 92 | 0.0008 | 0.9693
 86 | 0.0008 | 0.9691
 90 | 0.0008 | 0.9696

Training on entire training set needed 83 iterations, ended with loss 0.0008 and achieved accuracy 0.9741.

ni = number of iterations
acc = accuracy

Best performing tolerance is 1e-05 with accuracy 0.9741.

Time elapsed: 340.611 s

THIRD CROSS-VALIDATION (FOR NEURON WEIGHTS DUE TO DIFFERENT RANDOM INITIALIZATIONS)
-----------------------------------------------------------------------------------

 rs | acc
------------
 10 | 0.9577
 74 | 0.9680
 50 | 0.9638
 31 | 0.9631
 68 | 0.9625
 90 | 0.9616
 38 | 0.9660
 30 | 0.9667
 26 | 0.9682
 92 | 0.9685

rs = random state
acc = accuracy

Time elapsed: 746.935 s

PREDICT LABELS FOR TEST SET AND COMPUTE ACCURACY
------------------------------------------------

Accuracy of MLP on the entire training set with

  - optimal number of neurons = 100
  - optimal learning rate = 0.1
  - optimal tolerance = 1e-05
  - best performing randomly initialized weights

is 0.9730
   ======

Time elapsed: 0.053 s.

